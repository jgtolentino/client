import{j as e}from"./ui-vendor-DFluZlcK.js";import{u as z,C as m,a as p,S as E,b as M,c as B,D as V,d as F,B as H,e as $,f as d}from"./index-eY1K4Q0h.js";import{f as u,a as A,b as I}from"./format-utils-bn6WP3J2.js";import{r as K}from"./react-vendor-7S4FQL_3.js";import{l as R,F as f,E as W,D as g,m as G}from"./icon-vendor-BiN7dS6p.js";import{R as j,B as X,C as y,X as b,Y as N,T as v,a as Y,b as q,L as J,c as O}from"./chart-vendor-t5epH8ff.js";import"./query-vendor-M5hTytP1.js";import"./util-vendor-B2rm_Apj.js";function re(){const{kpiMetrics:n,trendData:k,isLoading:w}=z(),[l,x]=K.useState("hourly");if(w)return e.jsx(m,{className:"h-full",children:e.jsx(p,{className:"p-6",children:e.jsx(E,{className:"h-full w-full"})})});const o=(n==null?void 0:n.trendsData)||[],C=k||[],i=o.map(s=>{const a=parseInt(s.label.split(":")[0]),t=a>=6&&a<=9||a>=17&&a<=20;return{...s,isPeak:t}}),D=i.reduce((s,a)=>a.value>s.value?a:s,i[0]||{label:"",value:0,isPeak:!1}),S=o.reduce((s,a)=>s+a.value,0),L=o.some(s=>Math.abs(s.change||0)>5),c=s=>{console.log(`Exporting as ${s}`)},P=({active:s,payload:a,label:t})=>{if(s&&a&&a[0]){const r=a[0].payload;return e.jsxs("div",{className:"bg-white p-3 rounded shadow-lg border border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium",children:t}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Volume: ",h(a[0].value)]}),r.isPeak&&e.jsxs("p",{className:"text-xs text-orange-600 font-medium flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),"Peak Hour"]}),r.change!==void 0&&e.jsxs("p",{className:`text-xs ${r.change>0?"text-green-600":"text-red-600"}`,children:["Change: ",r.change>0?"+":"",r.change,"%"]})]})}return null},T=({active:s,payload:a,label:t})=>s&&a&&a[0]?e.jsxs("div",{className:"bg-white p-3 rounded shadow-lg border border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium",children:t}),e.jsx("p",{className:"text-sm text-yellow-600",children:I(a[0].value)})]}):null,h=s=>s.toLocaleString();return e.jsxs(m,{className:"shadow-sm border border-gray-200 relative h-full",children:[L&&e.jsx("div",{className:"absolute",style:{top:"16px",right:"56px",zIndex:10},children:e.jsxs("div",{className:"relative flex",style:{height:"12px",width:"12px"},children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-purple-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full bg-purple-500",style:{height:"12px",width:"12px"}})]})}),e.jsxs(M,{className:"flex flex-row items-center justify-between space-y-0",style:{padding:"16px 20px",paddingBottom:"12px"},children:[e.jsxs("div",{children:[e.jsxs(B,{className:"font-semibold flex items-center",style:{fontSize:"16px",gap:"8px"},children:["Transaction Trends",e.jsxs("span",{className:"font-normal text-muted-foreground bg-blue-50 text-blue-600 rounded",style:{fontSize:"11px",padding:"2px 8px"},children:[l==="hourly"?"Hourly":"Daily"," Analysis"]})]}),e.jsxs("div",{className:"flex items-center text-muted-foreground",style:{gap:"16px",marginTop:"8px",fontSize:"11px"},children:[e.jsxs("span",{className:"flex items-center",style:{gap:"4px"},children:[e.jsx(R,{style:{width:"12px",height:"12px"}}),"Peak: ",D.label]}),e.jsxs("span",{children:["24h volume: ",h(S)]}),e.jsxs("span",{className:"flex items-center text-orange-600",style:{gap:"4px"},children:[e.jsx(f,{style:{width:"12px",height:"12px"}}),"Peak hours: 6-9 AM, 5-8 PM"]})]})]}),e.jsxs("div",{className:"flex items-center",style:{gap:"8px"},children:[e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("button",{className:`px-3 py-1 text-xs font-medium rounded-l-md border ${l==="hourly"?"bg-primary text-primary-foreground border-primary":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,onClick:()=>x("hourly"),children:"Hourly"}),e.jsx("button",{className:`px-3 py-1 text-xs font-medium rounded-r-md border-t border-r border-b ${l==="daily"?"bg-primary text-primary-foreground border-primary":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,onClick:()=>x("daily"),children:"Daily"})]}),e.jsxs(V,{children:[e.jsx(F,{asChild:!0,children:e.jsx(H,{variant:"ghost",size:"sm",style:{padding:"4px"},children:e.jsx(W,{style:{width:"20px",height:"20px"}})})}),e.jsxs($,{align:"end",children:[e.jsxs(d,{onClick:()=>c("csv"),children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Export as CSV"]}),e.jsxs(d,{onClick:()=>c("png"),children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Export as PNG"]}),e.jsxs(d,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Share Insight"]})]})]})]})]}),e.jsx(p,{style:{padding:"0 20px 20px",height:"calc(100% - 80px)"},children:l==="hourly"?e.jsx("div",{className:"h-full",children:e.jsx(j,{width:"100%",height:"100%",children:e.jsxs(X,{data:i,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(b,{dataKey:"label",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#666"},interval:1}),e.jsx(N,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#666"},tickFormatter:s=>u(s)}),e.jsx(v,{content:e.jsx(P,{})}),e.jsx(Y,{dataKey:"value",radius:[6,6,0,0],animationDuration:1e3,children:i.map((s,a)=>e.jsx(q,{fill:s.isPeak?"#f97316":"#3b82f6"},`cell-${a}`))})]})})}):e.jsx("div",{className:"h-full",children:e.jsx(j,{width:"100%",height:"100%",children:e.jsxs(J,{data:C,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(b,{dataKey:"period",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#666"},tickFormatter:s=>A(s),interval:"preserveStartEnd"}),e.jsx(N,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#666"},tickFormatter:s=>u(s)}),e.jsx(v,{content:e.jsx(T,{})}),e.jsx(O,{type:"monotone",dataKey:"pesoValue",stroke:"#f59e0b",strokeWidth:3,dot:{fill:"#f59e0b",strokeWidth:2,r:4},activeDot:{r:6},animationDuration:1e3})]})})})})]})}export{re as default};
