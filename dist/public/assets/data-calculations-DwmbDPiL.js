import{j as y,v as _,w as I}from"./ui-vendor-DFluZlcK.js";import{r as j}from"./react-vendor-7S4FQL_3.js";import{h as q}from"./index-3kicyIA1.js";const M=j.forwardRef(({className:r,value:o,...i},a)=>y.jsx(_,{ref:a,className:q("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...i,children:y.jsx(I,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(o||0)}%)`}})}));M.displayName=_.displayName;const O=r=>{if(!r||r.length===0)return null;const o=r.filter(e=>e.was_recommended),i=o.filter(e=>e.influence_success),a={totalInfluenced:o.length,successfulInfluenced:i.length,influenceRate:o.length/r.length*100,successRate:o.length>0?i.length/o.length*100:0},f=r.reduce((e,n)=>{var h;const l=n.hour||parseInt(((h=n.time)==null?void 0:h.split(":")[0])||"0");return e[l]||(e[l]={count:0,value:0}),e[l].count++,e[l].value+=n.peso_value||0,e},{}),p=Object.entries(f).map(([e,n])=>({hour:parseInt(e),...n,isPeak:parseInt(e)>=6&&parseInt(e)<=9||parseInt(e)>=17&&parseInt(e)<=20})).sort((e,n)=>n.count-e.count),t=r.filter(e=>e.originally_requested&&e.originally_requested!==e.brand),s=t.length/r.length*100,u=t.reduce((e,n)=>{const l=`${n.originally_requested} → ${n.brand}`;return e[l]||(e[l]=0),e[l]++,e},{}),g=Object.entries(u).sort(([,e],[,n])=>n-e).slice(0,5).map(([e,n])=>{const[l,h]=e.split(" → ");return{from:l,to:h,count:n}}),v=r.reduce((e,n)=>e+(n.duration_seconds||0),0)/r.length,w=r.reduce((e,n)=>e+(n.units||0),0)/r.length,k={quick:r.filter(e=>e.duration_seconds<60).length,normal:r.filter(e=>e.duration_seconds>=60&&e.duration_seconds<180).length,long:r.filter(e=>e.duration_seconds>=180).length},d=r.filter(e=>e.is_weekend),c=r.filter(e=>!e.is_weekend),b={weekend:{count:d.length,avgValue:d.reduce((e,n)=>e+n.peso_value,0)/d.length||0,percentage:d.length/r.length*100},weekday:{count:c.length,avgValue:c.reduce((e,n)=>e+n.peso_value,0)/c.length||0,percentage:c.length/r.length*100}},m=r.reduce((e,n)=>(e[n.category]||(e[n.category]={count:0,totalValue:0,units:0,avgMargin:0,margins:[]}),e[n.category].count++,e[n.category].totalValue+=n.peso_value||0,e[n.category].units+=n.units||0,n.margin_percentage&&e[n.category].margins.push(parseFloat(n.margin_percentage)),e),{});return Object.values(m).forEach(e=>{e.margins.length>0&&(e.avgMargin=e.margins.reduce((n,l)=>n+l,0)/e.margins.length),delete e.margins}),{storeInfluence:a,peakHours:p,substitutionRate:s,topSubstitutions:g,avgDuration:v,avgUnits:w,durationDistribution:k,weekendVsWeekday:b,categoryMetrics:m}},P=(r,o)=>{const i=r.reduce((t,s)=>{const u=s.request_method||"Unknown";return t[u]||(t[u]={count:0,percentage:0}),t[u].count++,t},{}),a=Object.values(i).reduce((t,s)=>t+s.count,0);Object.values(i).forEach(t=>{t.percentage=t.count/a*100});const f={gender:o.reduce((t,s)=>(t[s.gender||"Unknown"]=(t[s.gender||"Unknown"]||0)+1,t),{}),ageGroups:o.reduce((t,s)=>{const u=s.age||0,g=u<18?"Under 18":u<25?"18-24":u<35?"25-34":u<45?"35-44":u<55?"45-54":"55+";return t[g]=(t[g]||0)+1,t},{}),locations:o.reduce((t,s)=>(t[s.location||"Unknown"]=(t[s.location||"Unknown"]||0)+1,t),{})},p=[{signal:"Brand Loyalty",strength:o.reduce((t,s)=>t+(s.brand_loyalty_score||0),0)/o.length*10,trend:"+2%"},{signal:"Price Sensitivity",strength:o.reduce((t,s)=>t+(s.price_sensitivity_score||0),0)/o.length*10,trend:"-1%"},{signal:"Quality Focus",strength:Math.random()*30+60,trend:"+3%"},{signal:"Convenience",strength:Math.random()*20+40,trend:"0%"}];return{requestMethods:Object.entries(i).map(([t,s])=>({method:t,...s})),demographics:f,preferences:p}};export{M as P,P as a,O as c};
